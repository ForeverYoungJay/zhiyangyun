services:
  postgres:
    image: postgres:16
    container_name: smartcare-postgres
    environment:
      POSTGRES_DB: smartcare
      POSTGRES_USER: smartcare
      POSTGRES_PASSWORD: smartcare
    ports: ["5432:5432"]
    volumes: ["pgdata:/var/lib/postgresql/data"]

  redis:
    image: redis:7
    container_name: smartcare-redis
    ports: ["6379:6379"]

  backend:
    build: ../backend
    container_name: smartcare-backend
    environment:
      DATABASE_URL: postgresql+asyncpg://smartcare:smartcare@postgres:5432/smartcare
      REDIS_URL: redis://redis:6379/0
      JWT_SECRET: smartcare-dev-secret
    depends_on: [postgres, redis]
    ports: ["8000:8000"]

  web-admin:
    build: ../web-admin
    container_name: smartcare-web-admin
    depends_on: [backend]
    ports: ["3000:3000"]

volumes:
  pgdata:
